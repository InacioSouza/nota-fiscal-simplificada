<div class="nota">

    <div class="dados__nota">
        <div class="dt__cliente">

            <div class="data__emissao">

                <h2>Data de emissão</h2>

                <dx-date-box type="date" [value]="dataHoje" width="170"
                    [inputAttr]="{ 'aria-label': 'Date' }"></dx-date-box>
            </div>

            <div class="cliente">

                <h2>Cliente</h2>

                <dx-select-box [(value)]="clienteSelecionado" width="300" [items]="clientes" displayExpr="nome"
                    placeholder="Selecione um Cliente" [searchEnabled]="true">

                    <dx-validator>
                        <dxi-validation-rule type="required"
                            message="Por favor, selecione um cliente."></dxi-validation-rule>
                    </dx-validator>

                </dx-select-box>
            </div>
        </div>


        <!---->

        <div class="itens">

            <h2>Itens</h2>

            <dx-data-grid #vamos [dataSource]="itensFormDataSource" [showBorders]="true" [columnAutoWidth]="true">

                <dxo-editing mode="row" [allowUpdating]="true" [allowDeleting]="true" [allowAdding]="true"
                    [useIcons]="true"></dxo-editing>



                <dxi-column caption="Produto" dataField="produto.nome" editCellTemplate="produto"></dxi-column>

                <dxi-column caption="Preço Unitário" dataField="precoUnitario" [allowEditing]="true"
                    editCellTemplate="precoUnit" hidingPriority="1"></dxi-column>

                <dxi-column caption="Quantidade" dataField="quantidade" editCellTemplate="qtdProduto"></dxi-column>

                <dxi-column caption="Valor Total" dataField="valorTotal" [allowEditing]="true"
                    editCellTemplate="valorTot"></dxi-column>


                <dxi-column type="buttons" [width]="110" [buttons]="customButtons">
                    <dxi-button hint="Salvar" icon="save" [visible]="isCloneIconVisible" [onClick]="addItem()"></dxi-button>
                    <dxi-button name="save" [visible]="false" [disabled]="true"></dxi-button>
                    <dxi-button name="edit"></dxi-button>
                    <dxi-button name="delete"></dxi-button>
                </dxi-column>

                <dxo-toolbar>
                    <dxi-item name="addRowButton" showText="always" [options]="{text: 'novo item'}"></dxi-item>
                </dxo-toolbar>

                <div *dxTemplate="let selectPdt of 'produto'">
                    <dx-select-box [items]="produtos" [(value)]="produtoSelecionado" displayExpr="nome"
                        placeholder="Selecione um produto" [searchEnabled]="true"
                        (onValueChanged)="mostraPrecoUnit($event)">
                    </dx-select-box>
                </div>

                <div *dxTemplate="let preco of 'precoUnit'">
                    <p>{{ precoUnit | currency }}</p>
                </div>

                <div *dxTemplate="let qtd of 'qtdProduto'">
                    <dx-number-box [(value)]="qtdProduto" format="#" [min]="1"
                        [inputAttr]="{ 'aria-label': 'Integer Format'}" (onChange)="calculaValorItem()"
                        (onValueChanged)="vinculaPdtTemplateAPdtData($event, qtd.row.data)">

                    </dx-number-box>
                </div>



                <div *dxTemplate="let valorT of 'valorTot'">
                    <p>{{valorTotalItem | currency}}</p>
                </div>

            </dx-data-grid>

        </div>

    </div>

    <div class="valor__tot__emit">
        <dx-number-box label="Valor da nota" [width]="150" labelMode="outside" format="R$ #,##0.##" currency="BRL"
            [(value)]="valorTotalNota" [readOnly]="true">
        </dx-number-box>

        <dx-button class="btn__add__item" [width]="200" text="Emitir nota" (onClick)="0" stylingMode="outlined"
            type="success"></dx-button>
    </div>
</div>